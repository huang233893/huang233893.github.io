(()=>{let s="statusTagsData",n=[];function r(t){Array.isArray(t)&&document.querySelectorAll(".flink-list-item").forEach(a=>{if(!a.querySelector(".status-tag")){var s=a.querySelector(".flink-item-name, .cf-friends-name");if(s){let e=s.textContent.trim();s=t.find(t=>t.name===e);if(s){var n=document.createElement("div");n.classList.add("status-tag");let t="未知",e="status-tag-red";0<=s.latency&&(t=s.latency.toFixed(2)+" s",e=s.latency<=2?"status-tag-green":s.latency<=5?"status-tag-light-yellow":s.latency<=10?"status-tag-dark-yellow":"status-tag-red"),n.textContent=t,n.classList.add(e),a.style.position="relative",a.appendChild(n)}}}})}function t(){var t=localStorage.getItem(s);if(t)try{var e=JSON.parse(t),a=Array.isArray(e.data)?e.data:e.data?.link_status||[];Date.now()-new Date(e.timestamp).getTime()<18e5&&r(n=a)}catch(t){console.warn("❌ 解析缓存失败，忽略缓存",t)}fetch("https://link.sumi233.top/result.json?t="+Date.now()).then(t=>t.json()).then(t=>{r(n=Array.isArray(t)?t:t.link_status||[]),localStorage.setItem(s,JSON.stringify({data:n,timestamp:(new Date).toISOString()}))}).catch(t=>console.error("❌ 获取 result.json 出错:",t))}document.addEventListener("DOMContentLoaded",()=>{t(),new MutationObserver(()=>r(n)).observe(document.body,{childList:!0,subtree:!0})}),document.addEventListener("pjax:complete",()=>{t()})})();