{"title":"Trunk VTP and pVLAN","slug":"CCNP/CCNP交换 Trunk VTP and pVLAN","date":"2024-10-17T07:01:46.000Z","updated":"2025-08-02T10:17:53.082Z","comments":true,"path":"api/articles/CCNP/CCNP交换 Trunk VTP and pVLAN.json","excerpt":null,"covers":["https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(4).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(2).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(3).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(5).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(7).png","https://img.picgo.net/2024/11/19/image-5b89cbafacef6088c.png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(1).png"],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"VLAN范围（Dot1Q）\"><a href=\"#VLAN范围（Dot1Q）\" class=\"headerlink\" title=\"VLAN范围（Dot1Q）\"></a>VLAN范围（Dot1Q）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(4).png\"></p>\n<ul>\n<li>0，4095\t保留，系统使用</li>\n<li>1\t思科默认vlan</li>\n<li>2-1001\tFor Ethernet VLANs</li>\n<li>1002-1005\t思科默认为FDDI及TokenRing</li>\n<li>1006-4094\t只能为Ethernet使用，在一些特殊平台使用</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(2).png\"></p>\n<h2 id=\"Trunking配置\"><a href=\"#Trunking配置\" class=\"headerlink\" title=\"Trunking配置\"></a>Trunking配置</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(3).png\"></p>\n<ul>\n<li>Trunk可以手工静态配置或者通过DTP进行协商</li>\n<li>DTP是的交换机之间能够进行trunk协商</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(5).png\"></p>\n<h2 id=\"Trunk相关配置\"><a href=\"#Trunk相关配置\" class=\"headerlink\" title=\"Trunk相关配置\"></a>Trunk相关配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# switchport mode access\t#接口设置access模式</span><br><span class=\"line\">Switch(config)# switchport mode encapsulation &#123;dot1q | ISL&#125;\t#如果接口是trunk，设置干道协议类型</span><br><span class=\"line\">Switch(config)# switchport mode dynamic &#123;auto | desirable&#125;\t#将接口设置为DTP动态协商，可选auto或者desirable</span><br><span class=\"line\">Switch(config)# switchport nonegotiate\t#将接口设置为nonegotiate，不发送DTP帧，如果配置非协商，那么就必须手工配置接口模式，为access或者trunk</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"VTP（VLAN-Trunking-Protocol）\"><a href=\"#VTP（VLAN-Trunking-Protocol）\" class=\"headerlink\" title=\"VTP（VLAN Trunking Protocol）\"></a>VTP（VLAN Trunking Protocol）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(7).png\"></p>\n<ul>\n<li>思科的私有协议</li>\n<li>只能传递VLAN信息</li>\n<li>简化大型园区网中VLAN信息库同步的问题（同一个VTP管理域中）</li>\n<li>只同步VLAN信息</li>\n<li>需要交换机之间的trunk链路支持</li>\n</ul>\n<h2 id=\"VTP模式\"><a href=\"#VTP模式\" class=\"headerlink\" title=\"VTP模式\"></a>VTP模式</h2><h3 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h3><ul>\n<li>可创建修改删除VLAN</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>VLAN信息存储于NVRAM</li>\n<li>Catalyst交换机默认是server模式</li>\n</ul>\n<h3 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h3><ul>\n<li>不能创建修改删除VLAN</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>VLAN信息不会存贮于NVRAM</li>\n</ul>\n<h3 id=\"Transparent\"><a href=\"#Transparent\" class=\"headerlink\" title=\"Transparent\"></a>Transparent</h3><ul>\n<li>可创建修改删除VLAN </li>\n<li>转发信息宣告</li>\n<li>不同步 不始发</li>\n<li>VLAN信息存贮于NVRAM</li>\n</ul>\n<h3 id=\"Tips：\"><a href=\"#Tips：\" class=\"headerlink\" title=\"Tips：\"></a>Tips：</h3><ul>\n<li>删除VLAN配置请使用<code>delete flash:config.text</code>，切勿使用<code>delete flash:</code>，这将会清除flash中的IOS固件</li>\n</ul>\n<h2 id=\"VTP的运作\"><a href=\"#VTP的运作\" class=\"headerlink\" title=\"VTP的运作\"></a>VTP的运作</h2><ul>\n<li>VTP协议通过组播地址0100-0CCC-CCCC在trunk链路上发送VTP通告</li>\n<li>VTP Server和clients通过最高的修订号来同步数据部</li>\n<li>VTP协议每隔5分钟发送一次VTP通告或者有变化时发生</li>\n</ul>\n<p><img src=\"https://img.picgo.net/2024/11/19/image-5b89cbafacef6088c.png\"></p>\n<h2 id=\"VTP的配置\"><a href=\"#VTP的配置\" class=\"headerlink\" title=\"VTP的配置\"></a>VTP的配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# vtp domain cisco\t#配置VTP域名</span><br><span class=\"line\">Switch(config)# vtp mode &#123; server | client | transparent &#125;\t#配置本机VTP模式</span><br><span class=\"line\">Switch(config)# vtp password x\t#（可选）配置密码</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"私有VLAN（PVLAN）\"><a href=\"#私有VLAN（PVLAN）\" class=\"headerlink\" title=\"私有VLAN（PVLAN）\"></a>私有VLAN（PVLAN）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(1).png\"></p>\n<ul>\n<li>主VLAN</li>\n<li>辅助VLAN</li>\n<li>团体VLANs</li>\n<li>混杂端口</li>\n</ul>\n<h2 id=\"PVLANs\"><a href=\"#PVLANs\" class=\"headerlink\" title=\"PVLANs\"></a>PVLANs</h2><ul>\n<li>将一个VLAN划分成几个单独的VLAN，这些VLAN都使用同一个IP网段</li>\n<li>可以提高安全性，降低子网数目，提高IP利用率</li>\n<li>尽管网络设备处于同一个子网中，但是他们属于不同的pVlan，pVlans之间的通信还是必须通过默认网关来实现。 </li>\n<li>每个pVLAN包括一个主VLAN以及多个辅助VLAN。</li>\n<li>所有的辅助VLAN都映射到主VLAN。辅助VLAN分为团体VLAN和隔离VLAN。</li>\n<li>相同团体VLAN能够互相通信(lay2)，但是团体VLAN之间必须通过设置SV或者路由器接口才能通信。</li>\n<li>相同隔离VLAN内部(端口之间)以及隔离VLAN之间都是不能够互相通信的，只能与混杂接口通信。</li>\n<li>一个主VLAN只能有一个Isolate vlan</li>\n<li>混杂端口能够与PVLAN中的任何设备通信，不管对方是处于主VLAN，还是辅助VLAN.</li>\n</ul>\n<h2 id=\"VLAN-port-types\"><a href=\"#VLAN-port-types\" class=\"headerlink\" title=\"VLAN port types\"></a>VLAN port types</h2><ul>\n<li>独立（Isolated）<ul>\n<li>仅与混杂端口通信</li>\n</ul>\n</li>\n<li>混杂（Promiscuous）<ul>\n<li>与所有其他端口通信</li>\n</ul>\n</li>\n<li>团体模式（Community）<ul>\n<li>与团体其他接口和所有混杂接口进行沟通</li>\n</ul>\n</li>\n</ul>\n","more":"<h2 id=\"VLAN范围（Dot1Q）\"><a href=\"#VLAN范围（Dot1Q）\" class=\"headerlink\" title=\"VLAN范围（Dot1Q）\"></a>VLAN范围（Dot1Q）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(4).png\"></p>\n<ul>\n<li>0，4095\t保留，系统使用</li>\n<li>1\t思科默认vlan</li>\n<li>2-1001\tFor Ethernet VLANs</li>\n<li>1002-1005\t思科默认为FDDI及TokenRing</li>\n<li>1006-4094\t只能为Ethernet使用，在一些特殊平台使用</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(2).png\"></p>\n<h2 id=\"Trunking配置\"><a href=\"#Trunking配置\" class=\"headerlink\" title=\"Trunking配置\"></a>Trunking配置</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(3).png\"></p>\n<ul>\n<li>Trunk可以手工静态配置或者通过DTP进行协商</li>\n<li>DTP是的交换机之间能够进行trunk协商</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(5).png\"></p>\n<h2 id=\"Trunk相关配置\"><a href=\"#Trunk相关配置\" class=\"headerlink\" title=\"Trunk相关配置\"></a>Trunk相关配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# switchport mode access\t#接口设置access模式</span><br><span class=\"line\">Switch(config)# switchport mode encapsulation &#123;dot1q | ISL&#125;\t#如果接口是trunk，设置干道协议类型</span><br><span class=\"line\">Switch(config)# switchport mode dynamic &#123;auto | desirable&#125;\t#将接口设置为DTP动态协商，可选auto或者desirable</span><br><span class=\"line\">Switch(config)# switchport nonegotiate\t#将接口设置为nonegotiate，不发送DTP帧，如果配置非协商，那么就必须手工配置接口模式，为access或者trunk</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"VTP（VLAN-Trunking-Protocol）\"><a href=\"#VTP（VLAN-Trunking-Protocol）\" class=\"headerlink\" title=\"VTP（VLAN Trunking Protocol）\"></a>VTP（VLAN Trunking Protocol）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(7).png\"></p>\n<ul>\n<li>思科的私有协议</li>\n<li>只能传递VLAN信息</li>\n<li>简化大型园区网中VLAN信息库同步的问题（同一个VTP管理域中）</li>\n<li>只同步VLAN信息</li>\n<li>需要交换机之间的trunk链路支持</li>\n</ul>\n<h2 id=\"VTP模式\"><a href=\"#VTP模式\" class=\"headerlink\" title=\"VTP模式\"></a>VTP模式</h2><h3 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h3><ul>\n<li>可创建修改删除VLAN</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>VLAN信息存储于NVRAM</li>\n<li>Catalyst交换机默认是server模式</li>\n</ul>\n<h3 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h3><ul>\n<li>不能创建修改删除VLAN</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>VLAN信息不会存贮于NVRAM</li>\n</ul>\n<h3 id=\"Transparent\"><a href=\"#Transparent\" class=\"headerlink\" title=\"Transparent\"></a>Transparent</h3><ul>\n<li>可创建修改删除VLAN </li>\n<li>转发信息宣告</li>\n<li>不同步 不始发</li>\n<li>VLAN信息存贮于NVRAM</li>\n</ul>\n<h3 id=\"Tips：\"><a href=\"#Tips：\" class=\"headerlink\" title=\"Tips：\"></a>Tips：</h3><ul>\n<li>删除VLAN配置请使用<code>delete flash:config.text</code>，切勿使用<code>delete flash:</code>，这将会清除flash中的IOS固件</li>\n</ul>\n<h2 id=\"VTP的运作\"><a href=\"#VTP的运作\" class=\"headerlink\" title=\"VTP的运作\"></a>VTP的运作</h2><ul>\n<li>VTP协议通过组播地址0100-0CCC-CCCC在trunk链路上发送VTP通告</li>\n<li>VTP Server和clients通过最高的修订号来同步数据部</li>\n<li>VTP协议每隔5分钟发送一次VTP通告或者有变化时发生</li>\n</ul>\n<p><img src=\"https://img.picgo.net/2024/11/19/image-5b89cbafacef6088c.png\"></p>\n<h2 id=\"VTP的配置\"><a href=\"#VTP的配置\" class=\"headerlink\" title=\"VTP的配置\"></a>VTP的配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# vtp domain cisco\t#配置VTP域名</span><br><span class=\"line\">Switch(config)# vtp mode &#123; server | client | transparent &#125;\t#配置本机VTP模式</span><br><span class=\"line\">Switch(config)# vtp password x\t#（可选）配置密码</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"私有VLAN（PVLAN）\"><a href=\"#私有VLAN（PVLAN）\" class=\"headerlink\" title=\"私有VLAN（PVLAN）\"></a>私有VLAN（PVLAN）</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/vtppvlan%20(1).png\"></p>\n<ul>\n<li>主VLAN</li>\n<li>辅助VLAN</li>\n<li>团体VLANs</li>\n<li>混杂端口</li>\n</ul>\n<h2 id=\"PVLANs\"><a href=\"#PVLANs\" class=\"headerlink\" title=\"PVLANs\"></a>PVLANs</h2><ul>\n<li>将一个VLAN划分成几个单独的VLAN，这些VLAN都使用同一个IP网段</li>\n<li>可以提高安全性，降低子网数目，提高IP利用率</li>\n<li>尽管网络设备处于同一个子网中，但是他们属于不同的pVlan，pVlans之间的通信还是必须通过默认网关来实现。 </li>\n<li>每个pVLAN包括一个主VLAN以及多个辅助VLAN。</li>\n<li>所有的辅助VLAN都映射到主VLAN。辅助VLAN分为团体VLAN和隔离VLAN。</li>\n<li>相同团体VLAN能够互相通信(lay2)，但是团体VLAN之间必须通过设置SV或者路由器接口才能通信。</li>\n<li>相同隔离VLAN内部(端口之间)以及隔离VLAN之间都是不能够互相通信的，只能与混杂接口通信。</li>\n<li>一个主VLAN只能有一个Isolate vlan</li>\n<li>混杂端口能够与PVLAN中的任何设备通信，不管对方是处于主VLAN，还是辅助VLAN.</li>\n</ul>\n<h2 id=\"VLAN-port-types\"><a href=\"#VLAN-port-types\" class=\"headerlink\" title=\"VLAN port types\"></a>VLAN port types</h2><ul>\n<li>独立（Isolated）<ul>\n<li>仅与混杂端口通信</li>\n</ul>\n</li>\n<li>混杂（Promiscuous）<ul>\n<li>与所有其他端口通信</li>\n</ul>\n</li>\n<li>团体模式（Community）<ul>\n<li>与团体其他接口和所有混杂接口进行沟通</li>\n</ul>\n</li>\n</ul>\n","categories":[{"name":"思科","path":"api/categories/思科.json"}],"tags":[{"name":"网络","path":"api/tags/网络.json"},{"name":"CCNP","path":"api/tags/CCNP.json"}]}