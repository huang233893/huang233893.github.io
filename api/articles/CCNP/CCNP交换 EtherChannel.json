{"title":"EtherChannal详解","slug":"CCNP/CCNP交换 EtherChannel","date":"2024-11-21T01:01:46.000Z","updated":"2025-08-02T09:53:40.249Z","comments":true,"path":"api/articles/CCNP/CCNP交换 EtherChannel.json","excerpt":null,"covers":["https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210282296-45cab1db-f0cb-412a-9681-ea25c5371e44.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210552290-923b722e-fa59-400d-8ad0-01aeeb5febe7.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211184779-0808aa71-e83c-42d3-a943-ba7fa545e288.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211269400-1daba43d-af56-4eec-96ee-5d97aee5b79c.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1729212993237-1a809b68-e3bc-4757-acee-38be5f7f66fe.png"],"content":"<meta name=\"referrer\" content=\"no-referrer\">\n\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210282296-45cab1db-f0cb-412a-9681-ea25c5371e44.png\"></p>\n<ul>\n<li>解决方案提供更多的带宽对类似链路进行逻辑聚合</li>\n<li>看成一个逻辑链接</li>\n<li>提供负载平衡和冗余支持</li>\n<li>支持Switch ports和Routed ports</li>\n</ul>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210552290-923b722e-fa59-400d-8ad0-01aeeb5febe7.png\"></p>\n<h2 id=\"PAgP-modes\"><a href=\"#PAgP-modes\" class=\"headerlink\" title=\"PAgP modes\"></a>PAgP modes</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211184779-0808aa71-e83c-42d3-a943-ba7fa545e288.png\"></p>\n<ul>\n<li>On\t通道成员不协商(无协议)</li>\n<li>Desirable\t主动询问对方是否可以&#x2F;将</li>\n<li>Auto\t被动等待对方询问</li>\n<li>Off\t未在接口上配置的 EtherChannel</li>\n</ul>\n<h2 id=\"LACP-modes\"><a href=\"#LACP-modes\" class=\"headerlink\" title=\"LACP modes\"></a>LACP modes</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211269400-1daba43d-af56-4eec-96ee-5d97aee5b79c.png\"></p>\n<ul>\n<li>On\t通道成员不协商(无协议)</li>\n<li>Active\t主动询问对方是否可以&#x2F;将</li>\n<li>Passive\t被动等待对方询问</li>\n<li>Off\t未在接口上配置的 EtherChannel</li>\n</ul>\n<h3 id=\"EtherChannel的配置\"><a href=\"#EtherChannel的配置\" class=\"headerlink\" title=\"EtherChannel的配置\"></a>EtherChannel的配置</h3><ul>\n<li>选择用于Channel的端口</li>\n<li>选择PAgP或LACP</li>\n<li>在接口上配置channel-group<ul>\n<li>设置channel-groupID</li>\n<li>根据特定的协议，选择接口模式完成</li>\n</ul>\n</li>\n<li>上述步骤后，逻辑的etherchannel接口就建立好了。<ul>\n<li>可以进一步对这个逻辑的etherchannel接口进行配置</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"EtherChannel的实施要点\"><a href=\"#EtherChannel的实施要点\" class=\"headerlink\" title=\"EtherChannel的实施要点\"></a>EtherChannel的实施要点</h2><ul>\n<li><strong>Port-channel接口一旦建立完成后，就形成了一个个逻辑的接口，后续针对该接口的配置在port-channel逻辑接口中完成</strong></li>\n<li><strong>最大支持8个端口做捆绑</strong></li>\n<li><strong>Port-channel接口不能成为SPAN的目的接口</strong></li>\n<li><strong>隶属于一个port-channel的物理接口需有相同的如下配置</strong><ul>\n<li>相同的speed和duplex</li>\n<li>相同的接口模式(access、trunk)</li>\n<li>如果是trunk模式，那么native vlan及allowed vlan需相同</li>\n<li>如果是access模式，所属vlan需相同</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"EC的负载均衡\"><a href=\"#EC的负载均衡\" class=\"headerlink\" title=\"EC的负载均衡\"></a>EC的负载均衡</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729212993237-1a809b68-e3bc-4757-acee-38be5f7f66fe.png\"> </p>\n<ul>\n<li>EtherChannel支持在同一个port-channel的链路中执行负载均衡</li>\n<li>负载均衡动作可以基于MAC、端口、IP(源IP、目的IP或两者)</li>\n<li>默认的行为:源目IP地址对(src-dst-ip)</li>\n</ul>\n<p><code>Switch(config)# port-channelload-balance type</code></p>\n<p><code>Switch# show etherchannelload-balance</code></p>\n<h2 id=\"EC的配置\"><a href=\"#EC的配置\" class=\"headerlink\" title=\"EC的配置\"></a>EC的配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# int range f0/1 - 2\t#进入接口范围</span><br><span class=\"line\">Switch(config-if-range)# switchport\t#将接口配置为二层接口</span><br><span class=\"line\">Switch(config-if-range)# switchport trunk encapsulation dot1q\t#trunk封装协议为dot1q</span><br><span class=\"line\">Switch(config-if-range)# switchport mode trunk\t#设置接口模式为Trunk模式</span><br><span class=\"line\">Switch(config-if-range)# channel-protocol pagp/lacp</span><br><span class=\"line\">Switch(config-if-range)# channel-group 1 mode desirable\t#配置etherchannel，ID为1，模式为desirable</span><br></pre></td></tr></table></figure>","more":"<meta name=\"referrer\" content=\"no-referrer\">\n\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210282296-45cab1db-f0cb-412a-9681-ea25c5371e44.png\"></p>\n<ul>\n<li>解决方案提供更多的带宽对类似链路进行逻辑聚合</li>\n<li>看成一个逻辑链接</li>\n<li>提供负载平衡和冗余支持</li>\n<li>支持Switch ports和Routed ports</li>\n</ul>\n<p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729210552290-923b722e-fa59-400d-8ad0-01aeeb5febe7.png\"></p>\n<h2 id=\"PAgP-modes\"><a href=\"#PAgP-modes\" class=\"headerlink\" title=\"PAgP modes\"></a>PAgP modes</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211184779-0808aa71-e83c-42d3-a943-ba7fa545e288.png\"></p>\n<ul>\n<li>On\t通道成员不协商(无协议)</li>\n<li>Desirable\t主动询问对方是否可以&#x2F;将</li>\n<li>Auto\t被动等待对方询问</li>\n<li>Off\t未在接口上配置的 EtherChannel</li>\n</ul>\n<h2 id=\"LACP-modes\"><a href=\"#LACP-modes\" class=\"headerlink\" title=\"LACP modes\"></a>LACP modes</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729211269400-1daba43d-af56-4eec-96ee-5d97aee5b79c.png\"></p>\n<ul>\n<li>On\t通道成员不协商(无协议)</li>\n<li>Active\t主动询问对方是否可以&#x2F;将</li>\n<li>Passive\t被动等待对方询问</li>\n<li>Off\t未在接口上配置的 EtherChannel</li>\n</ul>\n<h3 id=\"EtherChannel的配置\"><a href=\"#EtherChannel的配置\" class=\"headerlink\" title=\"EtherChannel的配置\"></a>EtherChannel的配置</h3><ul>\n<li>选择用于Channel的端口</li>\n<li>选择PAgP或LACP</li>\n<li>在接口上配置channel-group<ul>\n<li>设置channel-groupID</li>\n<li>根据特定的协议，选择接口模式完成</li>\n</ul>\n</li>\n<li>上述步骤后，逻辑的etherchannel接口就建立好了。<ul>\n<li>可以进一步对这个逻辑的etherchannel接口进行配置</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"EtherChannel的实施要点\"><a href=\"#EtherChannel的实施要点\" class=\"headerlink\" title=\"EtherChannel的实施要点\"></a>EtherChannel的实施要点</h2><ul>\n<li><strong>Port-channel接口一旦建立完成后，就形成了一个个逻辑的接口，后续针对该接口的配置在port-channel逻辑接口中完成</strong></li>\n<li><strong>最大支持8个端口做捆绑</strong></li>\n<li><strong>Port-channel接口不能成为SPAN的目的接口</strong></li>\n<li><strong>隶属于一个port-channel的物理接口需有相同的如下配置</strong><ul>\n<li>相同的speed和duplex</li>\n<li>相同的接口模式(access、trunk)</li>\n<li>如果是trunk模式，那么native vlan及allowed vlan需相同</li>\n<li>如果是access模式，所属vlan需相同</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"EC的负载均衡\"><a href=\"#EC的负载均衡\" class=\"headerlink\" title=\"EC的负载均衡\"></a>EC的负载均衡</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1729212993237-1a809b68-e3bc-4757-acee-38be5f7f66fe.png\"> </p>\n<ul>\n<li>EtherChannel支持在同一个port-channel的链路中执行负载均衡</li>\n<li>负载均衡动作可以基于MAC、端口、IP(源IP、目的IP或两者)</li>\n<li>默认的行为:源目IP地址对(src-dst-ip)</li>\n</ul>\n<p><code>Switch(config)# port-channelload-balance type</code></p>\n<p><code>Switch# show etherchannelload-balance</code></p>\n<h2 id=\"EC的配置\"><a href=\"#EC的配置\" class=\"headerlink\" title=\"EC的配置\"></a>EC的配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Switch(config)# int range f0/1 - 2\t#进入接口范围</span><br><span class=\"line\">Switch(config-if-range)# switchport\t#将接口配置为二层接口</span><br><span class=\"line\">Switch(config-if-range)# switchport trunk encapsulation dot1q\t#trunk封装协议为dot1q</span><br><span class=\"line\">Switch(config-if-range)# switchport mode trunk\t#设置接口模式为Trunk模式</span><br><span class=\"line\">Switch(config-if-range)# channel-protocol pagp/lacp</span><br><span class=\"line\">Switch(config-if-range)# channel-group 1 mode desirable\t#配置etherchannel，ID为1，模式为desirable</span><br></pre></td></tr></table></figure>","categories":[{"name":"思科","path":"api/categories/思科.json"}],"tags":[{"name":"网络","path":"api/tags/网络.json"},{"name":"CCNP","path":"api/tags/CCNP.json"}]}