{"title":"VLAN基础","slug":"CCNA/VLAN基础","date":"2024-10-17T07:01:46.000Z","updated":"2025-08-01T15:11:04.477Z","comments":true,"path":"api/articles/CCNA/VLAN基础.json","excerpt":null,"covers":["https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261880185-f61475a1-7523-4625-bd01-30f41e930bec.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261984139-0609b985-a483-4055-bdee-b2c57a47cba0.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261657279-d246491a-12c9-465a-9ad7-2bdcddc31dee.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261710061-f3a8792b-648d-4b3e-a4f9-9658ce187a77.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727253192833-a4d3a08b-6a08-473c-89f5-a728f93219aa.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232795002-f91da91e-f3d1-4769-90f7-5a1f695d9f6b.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232857479-d7dc114a-8b8b-411a-95d9-30e0df6bbadf.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262262150-ca39be19-8d3a-4ca5-9740-affe0d19cdb1.png","https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262775728-359c02e7-1c19-4ed2-8757-71c88d6e1b6c.png"],"content":"<meta name=\"referrer\" content=\"no-referrer\">\n\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261880185-f61475a1-7523-4625-bd01-30f41e930bec.png\"></p>\n<ul>\n<li>VLAN即虚拟局域网，是将一个物理的LAN在逻辑上划分成多个广播域的通讯技术</li>\n<li>每个VLAN内可以互相通讯，而每个VLAN之间是完全隔离开的，并不能直接互通，每个VLAN间的广播报文就被隔离开来。</li>\n</ul>\n<h2 id=\"VLAN的作用\"><a href=\"#VLAN的作用\" class=\"headerlink\" title=\"VLAN的作用\"></a>VLAN的作用</h2><ul>\n<li><strong>限制广播域：</strong>广播域被限制在一个VLAN之中，节省了带宽，提升网络处理的效率</li>\n<li><strong>增强局域网的安全性：</strong>不同VLAN之间的报文广播互相隔离，有效提升安全性</li>\n<li><strong>提升了局域网的稳定性：</strong>单个VLAN局域网出问题下机时不会影响到其他的VLAN正常运行</li>\n<li><strong>灵活构建虚拟工作组：</strong>不同需求的用户划分到不同的VLAN之间，各个VLAN间发挥不同作用</li>\n</ul>\n<h2 id=\"VLAN的特点\"><a href=\"#VLAN的特点\" class=\"headerlink\" title=\"VLAN的特点\"></a>VLAN的特点</h2><ul>\n<li>一个VLAN中所有设备都是在同一广播域内；广播不能跨越VLAN传播</li>\n<li>一个VLAN为一个逻辑子网；由被配置为此VLAN成员的设备组成，不同VLAN间需通过路由器实现互相通讯</li>\n<li>VLAN中成员多基于Switch端口号码，划分VLAN就是对Switch接口划分</li>\n<li>VLAN工作于OSI参考模型的第二层</li>\n</ul>\n<h2 id=\"VLAN的范围\"><a href=\"#VLAN的范围\" class=\"headerlink\" title=\"VLAN的范围\"></a>VLAN的范围</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261984139-0609b985-a483-4055-bdee-b2c57a47cba0.png\"></p>\n<ul>\n<li>VLAN 1-1001皆可正常使用，1范围无法进行删除，1001无法进行创建使用和删除</li>\n</ul>\n<h2 id=\"接口类型\"><a href=\"#接口类型\" class=\"headerlink\" title=\"接口类型\"></a>接口类型</h2><h3 id=\"Trunk接口\"><a href=\"#Trunk接口\" class=\"headerlink\" title=\"Trunk接口\"></a>Trunk接口</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261657279-d246491a-12c9-465a-9ad7-2bdcddc31dee.png\"></p>\n<p>Trunk一般用于路由器，交换机，AP间以及可同时收发Tagged帧和Untagged帧的终端之间支持互连，它可以允许多个VLAN的帧带Tag通过，但只允许一个VLAN的帧从该类接口上发出时不带Tag（即剥除Tag）。</p>\n<h3 id=\"Access接口\"><a href=\"#Access接口\" class=\"headerlink\" title=\"Access接口\"></a>Access接口</h3><p>Access接口一般用于和不能识别Tag的用户终端（如用户主机、服务器等）相连，或者不需要区分不同VLAN成员时使用。它只能收发Untagged帧，且只能为Untagged帧添加唯一VLAN的Tag。</p>\n<h3 id=\"Hybird接口\"><a href=\"#Hybird接口\" class=\"headerlink\" title=\"Hybird接口\"></a>Hybird接口</h3><p>Hybrid接口既可以用于连接不能识别Tag的用户终端（如用户主机、服务器等）和网络设备（如Hub），也可以用于连接交换机、路由器以及可同时收发Tagged帧和Untagged帧的语音终端、AP。它可以允许多个VLAN的帧带Tag通过，且允许从该类接口发出的帧根据需要配置某些VLAN的帧带Tag（即不剥除Tag）、某些VLAN的帧不带Tag（即剥除Tag）。</p>\n<h2 id=\"Mac硬件地址\"><a href=\"#Mac硬件地址\" class=\"headerlink\" title=\"Mac硬件地址\"></a>Mac硬件地址</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261710061-f3a8792b-648d-4b3e-a4f9-9658ce187a77.png\"></p>\n<ul>\n<li>MAC地址有48位，通常表示为点十六进制数。</li>\n<li>MAC地址全球唯一，有IEEE对这些地址进行管理的和分配。</li>\n<li>每个地址由两部分组成，分别是供应商代码和序列号。其中前24位二进制代表该供应商代码。剩下的24位由厂商自己分配。</li>\n</ul>\n<h2 id=\"802-1Q-Tag\"><a href=\"#802-1Q-Tag\" class=\"headerlink\" title=\"802.1Q Tag\"></a>802.1Q Tag</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727253192833-a4d3a08b-6a08-473c-89f5-a728f93219aa.png\"></p>\n<h3 id=\"802-1Q-帧标记\"><a href=\"#802-1Q-帧标记\" class=\"headerlink\" title=\"802.1Q 帧标记\"></a>802.1Q 帧标记</h3><ul>\n<li>默认情况下，在802.1Q Trunk上对所有的VLAN打Tag，除了Native VLAN；</li>\n<li>交换机根据以太网帧头信息来转发数据包；</li>\n</ul>\n<h3 id=\"Tag标记字段详细信息\"><a href=\"#Tag标记字段详细信息\" class=\"headerlink\" title=\"Tag标记字段详细信息\"></a>Tag标记字段详细信息</h3><ul>\n<li>Tag标记字段包含一个2 bytes EtherType（以太类型）字段、一个3Bits的PRi字段、1bit的CFI字段、12bits的VLAN ID字段；</li>\n</ul>\n<h2 id=\"ISL\"><a href=\"#ISL\" class=\"headerlink\" title=\"ISL\"></a>ISL</h2><h3 id=\"特点\"><a href=\"#特点\" class=\"headerlink\" title=\"特点\"></a>特点</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232795002-f91da91e-f3d1-4769-90f7-5a1f695d9f6b.png\"></p>\n<ul>\n<li>思科私有协议，仅可在思科的设备上互通</li>\n<li>通过硬件（ASIC）实现</li>\n<li>ISL标识不会出现在工作站，客户端并不知道ISL的封装信息</li>\n<li>在交换机或路由器与交换机之间，在交换机与具有ISL网卡的服务器之间可以实现；</li>\n</ul>\n<h3 id=\"报文形式\"><a href=\"#报文形式\" class=\"headerlink\" title=\"报文形式\"></a>报文形式</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232857479-d7dc114a-8b8b-411a-95d9-30e0df6bbadf.png\"></p>\n<h2 id=\"VTP\"><a href=\"#VTP\" class=\"headerlink\" title=\"VTP\"></a>VTP</h2><ul>\n<li>一个能够宣告VLAN的配置信息的信息系统；</li>\n<li>通过一个共有的管理域，维持VLAN配置信息的一致性；</li>\n<li>VTP只能在主干端口发送要宣告的信息；</li>\n<li>支持混合的介质主干链接（快速以太网，FDDI，ATM）；</li>\n</ul>\n<h3 id=\"VTP的运作\"><a href=\"#VTP的运作\" class=\"headerlink\" title=\"VTP的运作\"></a>VTP的运作</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262262150-ca39be19-8d3a-4ca5-9740-affe0d19cdb1.png\"></p>\n<ul>\n<li>VTP协议通过组播地址01-00-0C-CC-CC-CC在Trunk链路上发送VTP通告；</li>\n<li>VTP Server和Clients通过最高的修订号来同步数据库；</li>\n<li>VTP协议每隔五分钟发送一次VTP通告或者有变化时发生；</li>\n</ul>\n<h3 id=\"VTP模式\"><a href=\"#VTP模式\" class=\"headerlink\" title=\"VTP模式\"></a>VTP模式</h3><h4 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h4><ul>\n<li>删除vlan</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>存储于NVRAM中</li>\n<li>Catalyst交换机默认是server模式</li>\n</ul>\n<h4 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h4><ul>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>不会存储于NVRAM</li>\n</ul>\n<h4 id=\"Transparent\"><a href=\"#Transparent\" class=\"headerlink\" title=\"Transparent\"></a>Transparent</h4><ul>\n<li>创建修改删除VLAN</li>\n<li>转发</li>\n<li>信息宣告</li>\n<li>不同步</li>\n<li>存储于NVRAM</li>\n</ul>\n<h3 id=\"VTP-Pruning（修剪）\"><a href=\"#VTP-Pruning（修剪）\" class=\"headerlink\" title=\"VTP Pruning（修剪）\"></a>VTP Pruning（修剪）</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262775728-359c02e7-1c19-4ed2-8757-71c88d6e1b6c.png\"></p>\n<h2 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SW1(config)# vlan vlan-id</span><br><span class=\"line\">SW1(config-vlan)# switchport mode [mode]</span><br><span class=\"line\">SW1(config-vlan)# switchport access vlan [vlan-id | none]</span><br></pre></td></tr></table></figure>","more":"<meta name=\"referrer\" content=\"no-referrer\">\n\n<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261880185-f61475a1-7523-4625-bd01-30f41e930bec.png\"></p>\n<ul>\n<li>VLAN即虚拟局域网，是将一个物理的LAN在逻辑上划分成多个广播域的通讯技术</li>\n<li>每个VLAN内可以互相通讯，而每个VLAN之间是完全隔离开的，并不能直接互通，每个VLAN间的广播报文就被隔离开来。</li>\n</ul>\n<h2 id=\"VLAN的作用\"><a href=\"#VLAN的作用\" class=\"headerlink\" title=\"VLAN的作用\"></a>VLAN的作用</h2><ul>\n<li><strong>限制广播域：</strong>广播域被限制在一个VLAN之中，节省了带宽，提升网络处理的效率</li>\n<li><strong>增强局域网的安全性：</strong>不同VLAN之间的报文广播互相隔离，有效提升安全性</li>\n<li><strong>提升了局域网的稳定性：</strong>单个VLAN局域网出问题下机时不会影响到其他的VLAN正常运行</li>\n<li><strong>灵活构建虚拟工作组：</strong>不同需求的用户划分到不同的VLAN之间，各个VLAN间发挥不同作用</li>\n</ul>\n<h2 id=\"VLAN的特点\"><a href=\"#VLAN的特点\" class=\"headerlink\" title=\"VLAN的特点\"></a>VLAN的特点</h2><ul>\n<li>一个VLAN中所有设备都是在同一广播域内；广播不能跨越VLAN传播</li>\n<li>一个VLAN为一个逻辑子网；由被配置为此VLAN成员的设备组成，不同VLAN间需通过路由器实现互相通讯</li>\n<li>VLAN中成员多基于Switch端口号码，划分VLAN就是对Switch接口划分</li>\n<li>VLAN工作于OSI参考模型的第二层</li>\n</ul>\n<h2 id=\"VLAN的范围\"><a href=\"#VLAN的范围\" class=\"headerlink\" title=\"VLAN的范围\"></a>VLAN的范围</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261984139-0609b985-a483-4055-bdee-b2c57a47cba0.png\"></p>\n<ul>\n<li>VLAN 1-1001皆可正常使用，1范围无法进行删除，1001无法进行创建使用和删除</li>\n</ul>\n<h2 id=\"接口类型\"><a href=\"#接口类型\" class=\"headerlink\" title=\"接口类型\"></a>接口类型</h2><h3 id=\"Trunk接口\"><a href=\"#Trunk接口\" class=\"headerlink\" title=\"Trunk接口\"></a>Trunk接口</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261657279-d246491a-12c9-465a-9ad7-2bdcddc31dee.png\"></p>\n<p>Trunk一般用于路由器，交换机，AP间以及可同时收发Tagged帧和Untagged帧的终端之间支持互连，它可以允许多个VLAN的帧带Tag通过，但只允许一个VLAN的帧从该类接口上发出时不带Tag（即剥除Tag）。</p>\n<h3 id=\"Access接口\"><a href=\"#Access接口\" class=\"headerlink\" title=\"Access接口\"></a>Access接口</h3><p>Access接口一般用于和不能识别Tag的用户终端（如用户主机、服务器等）相连，或者不需要区分不同VLAN成员时使用。它只能收发Untagged帧，且只能为Untagged帧添加唯一VLAN的Tag。</p>\n<h3 id=\"Hybird接口\"><a href=\"#Hybird接口\" class=\"headerlink\" title=\"Hybird接口\"></a>Hybird接口</h3><p>Hybrid接口既可以用于连接不能识别Tag的用户终端（如用户主机、服务器等）和网络设备（如Hub），也可以用于连接交换机、路由器以及可同时收发Tagged帧和Untagged帧的语音终端、AP。它可以允许多个VLAN的帧带Tag通过，且允许从该类接口发出的帧根据需要配置某些VLAN的帧带Tag（即不剥除Tag）、某些VLAN的帧不带Tag（即剥除Tag）。</p>\n<h2 id=\"Mac硬件地址\"><a href=\"#Mac硬件地址\" class=\"headerlink\" title=\"Mac硬件地址\"></a>Mac硬件地址</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727261710061-f3a8792b-648d-4b3e-a4f9-9658ce187a77.png\"></p>\n<ul>\n<li>MAC地址有48位，通常表示为点十六进制数。</li>\n<li>MAC地址全球唯一，有IEEE对这些地址进行管理的和分配。</li>\n<li>每个地址由两部分组成，分别是供应商代码和序列号。其中前24位二进制代表该供应商代码。剩下的24位由厂商自己分配。</li>\n</ul>\n<h2 id=\"802-1Q-Tag\"><a href=\"#802-1Q-Tag\" class=\"headerlink\" title=\"802.1Q Tag\"></a>802.1Q Tag</h2><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727253192833-a4d3a08b-6a08-473c-89f5-a728f93219aa.png\"></p>\n<h3 id=\"802-1Q-帧标记\"><a href=\"#802-1Q-帧标记\" class=\"headerlink\" title=\"802.1Q 帧标记\"></a>802.1Q 帧标记</h3><ul>\n<li>默认情况下，在802.1Q Trunk上对所有的VLAN打Tag，除了Native VLAN；</li>\n<li>交换机根据以太网帧头信息来转发数据包；</li>\n</ul>\n<h3 id=\"Tag标记字段详细信息\"><a href=\"#Tag标记字段详细信息\" class=\"headerlink\" title=\"Tag标记字段详细信息\"></a>Tag标记字段详细信息</h3><ul>\n<li>Tag标记字段包含一个2 bytes EtherType（以太类型）字段、一个3Bits的PRi字段、1bit的CFI字段、12bits的VLAN ID字段；</li>\n</ul>\n<h2 id=\"ISL\"><a href=\"#ISL\" class=\"headerlink\" title=\"ISL\"></a>ISL</h2><h3 id=\"特点\"><a href=\"#特点\" class=\"headerlink\" title=\"特点\"></a>特点</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232795002-f91da91e-f3d1-4769-90f7-5a1f695d9f6b.png\"></p>\n<ul>\n<li>思科私有协议，仅可在思科的设备上互通</li>\n<li>通过硬件（ASIC）实现</li>\n<li>ISL标识不会出现在工作站，客户端并不知道ISL的封装信息</li>\n<li>在交换机或路由器与交换机之间，在交换机与具有ISL网卡的服务器之间可以实现；</li>\n</ul>\n<h3 id=\"报文形式\"><a href=\"#报文形式\" class=\"headerlink\" title=\"报文形式\"></a>报文形式</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727232857479-d7dc114a-8b8b-411a-95d9-30e0df6bbadf.png\"></p>\n<h2 id=\"VTP\"><a href=\"#VTP\" class=\"headerlink\" title=\"VTP\"></a>VTP</h2><ul>\n<li>一个能够宣告VLAN的配置信息的信息系统；</li>\n<li>通过一个共有的管理域，维持VLAN配置信息的一致性；</li>\n<li>VTP只能在主干端口发送要宣告的信息；</li>\n<li>支持混合的介质主干链接（快速以太网，FDDI，ATM）；</li>\n</ul>\n<h3 id=\"VTP的运作\"><a href=\"#VTP的运作\" class=\"headerlink\" title=\"VTP的运作\"></a>VTP的运作</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262262150-ca39be19-8d3a-4ca5-9740-affe0d19cdb1.png\"></p>\n<ul>\n<li>VTP协议通过组播地址01-00-0C-CC-CC-CC在Trunk链路上发送VTP通告；</li>\n<li>VTP Server和Clients通过最高的修订号来同步数据库；</li>\n<li>VTP协议每隔五分钟发送一次VTP通告或者有变化时发生；</li>\n</ul>\n<h3 id=\"VTP模式\"><a href=\"#VTP模式\" class=\"headerlink\" title=\"VTP模式\"></a>VTP模式</h3><h4 id=\"Server\"><a href=\"#Server\" class=\"headerlink\" title=\"Server\"></a>Server</h4><ul>\n<li>删除vlan</li>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>存储于NVRAM中</li>\n<li>Catalyst交换机默认是server模式</li>\n</ul>\n<h4 id=\"Client\"><a href=\"#Client\" class=\"headerlink\" title=\"Client\"></a>Client</h4><ul>\n<li>发送&#x2F;转发信息宣告</li>\n<li>同步</li>\n<li>不会存储于NVRAM</li>\n</ul>\n<h4 id=\"Transparent\"><a href=\"#Transparent\" class=\"headerlink\" title=\"Transparent\"></a>Transparent</h4><ul>\n<li>创建修改删除VLAN</li>\n<li>转发</li>\n<li>信息宣告</li>\n<li>不同步</li>\n<li>存储于NVRAM</li>\n</ul>\n<h3 id=\"VTP-Pruning（修剪）\"><a href=\"#VTP-Pruning（修剪）\" class=\"headerlink\" title=\"VTP Pruning（修剪）\"></a>VTP Pruning（修剪）</h3><p><img src=\"https://cdn.nlark.com/yuque/0/2024/png/44908083/1727262775728-359c02e7-1c19-4ed2-8757-71c88d6e1b6c.png\"></p>\n<h2 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SW1(config)# vlan vlan-id</span><br><span class=\"line\">SW1(config-vlan)# switchport mode [mode]</span><br><span class=\"line\">SW1(config-vlan)# switchport access vlan [vlan-id | none]</span><br></pre></td></tr></table></figure>","categories":[{"name":"思科","path":"api/categories/思科.json"}],"tags":[{"name":"网络","path":"api/tags/网络.json"},{"name":"CCNA","path":"api/tags/CCNA.json"}]}