{"title":"NAT基础","slug":"CCNA/NAT基础","date":"2024-10-17T07:01:46.000Z","updated":"2025-08-02T10:16:12.990Z","comments":true,"path":"api/articles/CCNA/NAT基础.json","excerpt":null,"covers":["https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(4).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(5).pngg","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(1).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(2).png","https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(3).png"],"content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>即Network Address Translation，网络地址转换。于1994年被提出。当在专业网内部的一些主机本来已经分配到了本地IP地址（即在本专用网内使用的专用地址），但现在又想和因特网上的主机通信（不需要加密的）的时候，就可以使用NAT技术。<br><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(4).png\"></p>\n<h2 id=\"为什么需要NAT\"><a href=\"#为什么需要NAT\" class=\"headerlink\" title=\"为什么需要NAT\"></a>为什么需要NAT</h2><ul>\n<li>主要为了解决IPv4地址紧缺的问题，通过将一个公网IP地址和多个私网IP相对应，从而解决IP地址不够用的情况，但是这种技术只是起到了缓解的作用，真正的方法还是得使用IPv6来解决。</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(5).pngg\"></p>\n<h2 id=\"NAT技术的优缺点\"><a href=\"#NAT技术的优缺点\" class=\"headerlink\" title=\"NAT技术的优缺点\"></a>NAT技术的优缺点</h2><h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>节省合法的公有的IP地址</li>\n<li>地址重叠时，提供一个较为完善的解决方法</li>\n<li>网络发生变化时，避免重新编址</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>无法进行端对端的ip追踪（破坏了端对端通讯的平等性）</li>\n<li>很多应用层无法识别（例如FTP协议）</li>\n</ul>\n<h2 id=\"NAT的三种类型\"><a href=\"#NAT的三种类型\" class=\"headerlink\" title=\"NAT的三种类型\"></a>NAT的三种类型</h2><h3 id=\"静态NAT\"><a href=\"#静态NAT\" class=\"headerlink\" title=\"静态NAT\"></a>静态NAT</h3><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(1).png\"></p>\n<ul>\n<li>将内部本地地址与内部全局地址进行一对一的明确转换。这种方法主要用于内部网络中有对外提供服务的服务器，如WEB、MAIL服务器时。该方法的缺点是需要独占宝贵的合法IP地址。即如果某个合法IP地址已经被NAT静态地址转换定义，即使该地址当前没有被使用，也不能用作其他的地址转换。</li>\n</ul>\n<h3 id=\"动态NAT\"><a href=\"#动态NAT\" class=\"headerlink\" title=\"动态NAT\"></a>动态NAT</h3><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(2).png\"></p>\n<ul>\n<li>动态地址转换也是将内部本地地址与内部全局地址进行一对一的转换。但是，是从内部全局地址池中动态地选择一个未使用的地址对内部本地地址进行转换。该地址是由未被使用的地址组成的地址池中在定义时排在最前面的一个。当数据传输完毕后，路由器将把使用完的内部全局地址放回到地址池中，以供其它内部本地地址进行转换。但是在该地址被使用时，不能用该地址再进行一次转换。</li>\n</ul>\n<h3 id=\"端口复用PAT\"><a href=\"#端口复用PAT\" class=\"headerlink\" title=\"端口复用PAT\"></a>端口复用PAT</h3><ul>\n<li>复用地址转换也称为端口地址转换(PortAddressTranslation，PAT)，首先是一种动态地址转换。路由器将通过记录地址、应用程序端口等唯一标识一个转换。通过这种转换，可以使多个内部本地地址同时与同一个内部全局地址进行转换并对外部网络进行访问。对于只申请到少量IP地址甚至只有一个合法IP地址，却经常有很多用户同时要求上网的情况，这种转换方式非常有用</li>\n<li>理想状况下，一个单一的IP地址可以使用的端口数为4000个</li>\n</ul>\n<h2 id=\"私有空间地址\"><a href=\"#私有空间地址\" class=\"headerlink\" title=\"私有空间地址\"></a>私有空间地址</h2><ul>\n<li>A类：10.0.0.0 - 10.255.255.255</li>\n<li>B类：172.16.0.0 - 172.31.255.255</li>\n<li>C类：192.168.0.0 - 192.168.255.255</li>\n</ul>\n<h2 id=\"NAT术语\"><a href=\"#NAT术语\" class=\"headerlink\" title=\"NAT术语\"></a>NAT术语</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(3).png\"></p>\n<ul>\n<li>内部本地——转换之前内部源地址的名字</li>\n<li>外部本地——转换之前目标主机的名字</li>\n<li>内部全局——转换之后内部主机的名字</li>\n<li>外部全局——转换之后外部目标主机名字</li>\n</ul>\n<h2 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(config)# ip nat inside source static local-ip global-ip</span><br><span class=\"line\">Router(config)# ip nat inside</span><br><span class=\"line\">Router(config)# ip nat outside</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(config)# ip nat pool name start-ip end-ip &#123;netmask netmask | prefix-length prefix-length&#125;</span><br><span class=\"line\">Router(config)# access-list access-list-number permit source [source-wildcard]</span><br><span class=\"line\">Router(config)# ip nat inside source list access-list-number pool name</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(conflg)# access-list access-list-number permit source source-wildcard</span><br><span class=\"line\">Router(config)# ip nat inside source list access-list-number interface interface overload</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>即Network Address Translation，网络地址转换。于1994年被提出。当在专业网内部的一些主机本来已经分配到了本地IP地址（即在本专用网内使用的专用地址），但现在又想和因特网上的主机通信（不需要加密的）的时候，就可以使用NAT技术。<br><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(4).png\"></p>\n<h2 id=\"为什么需要NAT\"><a href=\"#为什么需要NAT\" class=\"headerlink\" title=\"为什么需要NAT\"></a>为什么需要NAT</h2><ul>\n<li>主要为了解决IPv4地址紧缺的问题，通过将一个公网IP地址和多个私网IP相对应，从而解决IP地址不够用的情况，但是这种技术只是起到了缓解的作用，真正的方法还是得使用IPv6来解决。</li>\n</ul>\n<p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(5).pngg\"></p>\n<h2 id=\"NAT技术的优缺点\"><a href=\"#NAT技术的优缺点\" class=\"headerlink\" title=\"NAT技术的优缺点\"></a>NAT技术的优缺点</h2><h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>节省合法的公有的IP地址</li>\n<li>地址重叠时，提供一个较为完善的解决方法</li>\n<li>网络发生变化时，避免重新编址</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>无法进行端对端的ip追踪（破坏了端对端通讯的平等性）</li>\n<li>很多应用层无法识别（例如FTP协议）</li>\n</ul>\n<h2 id=\"NAT的三种类型\"><a href=\"#NAT的三种类型\" class=\"headerlink\" title=\"NAT的三种类型\"></a>NAT的三种类型</h2><h3 id=\"静态NAT\"><a href=\"#静态NAT\" class=\"headerlink\" title=\"静态NAT\"></a>静态NAT</h3><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(1).png\"></p>\n<ul>\n<li>将内部本地地址与内部全局地址进行一对一的明确转换。这种方法主要用于内部网络中有对外提供服务的服务器，如WEB、MAIL服务器时。该方法的缺点是需要独占宝贵的合法IP地址。即如果某个合法IP地址已经被NAT静态地址转换定义，即使该地址当前没有被使用，也不能用作其他的地址转换。</li>\n</ul>\n<h3 id=\"动态NAT\"><a href=\"#动态NAT\" class=\"headerlink\" title=\"动态NAT\"></a>动态NAT</h3><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(2).png\"></p>\n<ul>\n<li>动态地址转换也是将内部本地地址与内部全局地址进行一对一的转换。但是，是从内部全局地址池中动态地选择一个未使用的地址对内部本地地址进行转换。该地址是由未被使用的地址组成的地址池中在定义时排在最前面的一个。当数据传输完毕后，路由器将把使用完的内部全局地址放回到地址池中，以供其它内部本地地址进行转换。但是在该地址被使用时，不能用该地址再进行一次转换。</li>\n</ul>\n<h3 id=\"端口复用PAT\"><a href=\"#端口复用PAT\" class=\"headerlink\" title=\"端口复用PAT\"></a>端口复用PAT</h3><ul>\n<li>复用地址转换也称为端口地址转换(PortAddressTranslation，PAT)，首先是一种动态地址转换。路由器将通过记录地址、应用程序端口等唯一标识一个转换。通过这种转换，可以使多个内部本地地址同时与同一个内部全局地址进行转换并对外部网络进行访问。对于只申请到少量IP地址甚至只有一个合法IP地址，却经常有很多用户同时要求上网的情况，这种转换方式非常有用</li>\n<li>理想状况下，一个单一的IP地址可以使用的端口数为4000个</li>\n</ul>\n<h2 id=\"私有空间地址\"><a href=\"#私有空间地址\" class=\"headerlink\" title=\"私有空间地址\"></a>私有空间地址</h2><ul>\n<li>A类：10.0.0.0 - 10.255.255.255</li>\n<li>B类：172.16.0.0 - 172.31.255.255</li>\n<li>C类：192.168.0.0 - 192.168.255.255</li>\n</ul>\n<h2 id=\"NAT术语\"><a href=\"#NAT术语\" class=\"headerlink\" title=\"NAT术语\"></a>NAT术语</h2><p><img src=\"https://cdn.sumi233.top/gh/huang233893/blog-image-bed/top/huang233893/imgs/blog/NAT%20(3).png\"></p>\n<ul>\n<li>内部本地——转换之前内部源地址的名字</li>\n<li>外部本地——转换之前目标主机的名字</li>\n<li>内部全局——转换之后内部主机的名字</li>\n<li>外部全局——转换之后外部目标主机名字</li>\n</ul>\n<h2 id=\"基础配置\"><a href=\"#基础配置\" class=\"headerlink\" title=\"基础配置\"></a>基础配置</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(config)# ip nat inside source static local-ip global-ip</span><br><span class=\"line\">Router(config)# ip nat inside</span><br><span class=\"line\">Router(config)# ip nat outside</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(config)# ip nat pool name start-ip end-ip &#123;netmask netmask | prefix-length prefix-length&#125;</span><br><span class=\"line\">Router(config)# access-list access-list-number permit source [source-wildcard]</span><br><span class=\"line\">Router(config)# ip nat inside source list access-list-number pool name</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Router(conflg)# access-list access-list-number permit source source-wildcard</span><br><span class=\"line\">Router(config)# ip nat inside source list access-list-number interface interface overload</span><br><span class=\"line\">Router# show ip nat translations #查看配置情况</span><br></pre></td></tr></table></figure>","categories":[{"name":"思科","path":"api/categories/思科.json"}],"tags":[{"name":"网络","path":"api/tags/网络.json"},{"name":"CCNA","path":"api/tags/CCNA.json"}]}