var footprintChart=echarts.init(document.getElementById("footprint"));function getProvinceCounts(e){let t={};return e.forEach(e=>{t[e.province]?t[e.province]++:t[e.province]=1}),t}function getProvinceData(t){return["北京","天津","河北","山西","内蒙古","辽宁","吉林","黑龙江","上海","江苏","浙江","安徽","福建","江西","山东","河南","湖北","湖南","广东","广西","海南","重庆","四川","贵州","云南","西藏","陕西","甘肃","青海","宁夏","新疆","香港","澳门","台湾","南海诸岛"].map(e=>({name:e,value:t[e]||0}))}fetch("/json/footprint.json").then(e=>e.json()).then(e=>{let a=getProvinceCounts(e);var t=getProvinceData(a),o=Math.max(...Object.values(a),0);footprintChart.setOption({title:{show:!1,text:"酥米走过的地方",left:"center",top:15,textStyle:{fontSize:20,color:"#171a24",fontWeight:"bold",fontFamily:"serif"}},tooltip:{trigger:"item",borderColor:"#171a24",borderWidth:1,formatter:function(e){var t,o="";return"effectScatter"===e.seriesType?(o=`<div style="font-size: 16px">${e.name}</div>`,e.data&&e.data.description&&(o+=`<div>${e.data.description}</div>`)):"map"===e.seriesType&&(t=a[e.name]||0,o=`<div style="font-size: 16px">${e.name}</div>`,0<t)&&(o+=`<div>走过${t}座城</div>`),o}},visualMap:{show:!0,seriesIndex:1,min:0,max:0<o?o:1,inRange:{color:["#e6e6e6","#a7d0ed","#5ab7fb","#409de1","#398cc0","#0e76c0"]},outOfRange:{color:"#e6e6e6"},left:"5%",bottom:"5%",itemWidth:20,itemHeight:100,calculable:!0},geo:{map:"china",zoom:1.2,scaleLimit:{min:1,max:8},show:!0,roam:!0,emphasis:{label:{show:!1}},itemStyle:{normal:{areaColor:"#e6e6e6",borderColor:"#171a24"},emphasis:{areaColor:"#f1b03f"}}},series:[{name:"足迹",type:"effectScatter",coordinateSystem:"geo",data:e,geoIndex:0,showEffectOn:"render",hoverAnimation:!0,symbolSize:8,itemStyle:{normal:{color:"#ffffff",shadowBlur:10}}},{name:"省份访问次数",type:"map",mapType:"china",data:t,geoIndex:0,showLegendSymbol:!1}]})}).catch(e=>{console.error("Error loading footprint data:",e)}),window.addEventListener("resize",function(){footprintChart.resize()}),footprintChart.on("click",function(e){"effectScatter"===e.seriesType&&e.data&&e.data.url&&window.open(e.data.url,"_blank")}),footprintChart.getZr().on("dblclick",function(){footprintChart.setOption({geo:{zoom:1.2,center:null},visualMap:{range:null}})});